Ext.define("RegionalStore.controller.regionalstore",{extend:"Ext.app.Controller",config:{refs:{dashboardView:"dashboardview",productView:"productview",contactView:"contactview"},control:{dashboardView:{productTypeCommand:"onProductTypeCommand",productCommand:"onProductCommand",dashboardBackCommand:"onDashboardBackCommand",searchAllCommand:"onSearchAllCommand",regionsListItemCommand:"onRegionsListItemCommand",changeViewCommand:"onChangeViewCommand"},productView:{productBackCommand:"onProductBackCommand"},contactView:{contactBackCommand:"onContactBackCommand"}}},slideLeftTransition:{type:"slide",direction:"left"},slideRightTransition:{type:"slide",direction:"right"},currentFormat:"Grid",language:"name",currentData:"types",onProductTypeCommand:function(t,e){e&&e.data&&(this.currentData=e.data.name.toLowerCase(),this.currentView="ProductListView",this.goToDashboardView(!1))},onProductCommand:function(t,e){if(e&&e.data){var a=e.data;document.getElementById("productimage").src=a.src;var r=this.getProductView(),i=r.getComponent("productDetailsListView"),n=Ext.getStore("languages");n.each(function(t){t.data.word=a["English"==t.data.name?"name":t.data.name]}),i.setStore(n),i.setItemTpl('<div class="languageHeadnWord"><div class="languageHeading">{name}</div><div class="languageWord">{word}</div></div>'),i.refresh(),Ext.Viewport.animateActiveItem(r,this.slideLeftTransition)}},onProductBackCommand:function(){this.currentView="ProductListView",this.goToDashboardView(!0)},onDashboardBackCommand:function(t,e){"ProductListView"!=this.currentView?Ext.Viewport.animateActiveItem(this.getContactView(),this.slideLeftTransition):(e&&(this.currentData=e),this.currentView="DashboardView",this.goToDashboardView(!0))},onContactBackCommand:function(t,e){e&&(this.currentData=e),this.currentView="DashboardView",this.goToDashboardView(!0)},goToDashboardView:function(t,e){var a=Ext.ComponentQuery.query("#dashboardBack")[0],r=Ext.ComponentQuery.query("#regionButton")[0],i=Ext.ComponentQuery.query("#searchAll")[0],n=Ext.ComponentQuery.query("#dashboardHeader")[0];this.currentView&&"DashboardView"!=this.currentView?(a.removeCls("contactCls"),a.addCls("backCls"),r.show(),n.getTitle().setTitle("search"!=this.currentData?this.currentData:this.prevCurrentData)):(a.removeCls("backCls"),a.addCls("contactCls"),r.hide(),n.getTitle().setTitle("Regional Store"),"search"!=this.currentData&&(this.currentData="types","name"!=this.language&&(this.prevLanguage=this.language),this.language="name"),t&&i.setValue(""));var s=Ext.getStore(this.currentData),o=this.getDashboardView(),d=o.getComponent("productTypes"),c=o.getComponent("productsListView");this.prevLanguage&&"types"!=this.currentData&&(this.language=this.prevLanguage),"English"==this.language&&(this.language="name"),"Grid"==this.currentFormat?(d.setStore(s),d.setItemTpl('<div class="producttypediv"><img src={src}><div>{'+this.language+"}</div></div>"),d.refresh()):(c.setStore(s),c.setItemTpl('<div class="productsBasicListView"><span><img src={src}></span><span class="productListDetails">{'+this.language+"}</span></div>"),c.refresh()),e&&(c.isHidden()?(d.hide(),c.show()):(c.hide(),d.show())),c.refresh();var h=t?this.slideRightTransition:this.slideLeftTransition;Ext.Viewport.animateActiveItem(o,h)},onSearchAllCommand:function(t,e){var a=this,r=e?e.getValue():"",i=Ext.getStore("search");if(i.removeAll(),r.length>0){var n=!1;if("search"!=this.currentData?"types"==this.currentData&&(n=!0):"types"==this.prevCurrentData&&(n=!0),n){var s=Ext.getStore("types");s.each(function(t){var e=Ext.getStore(t.get("name").toLowerCase());e&&i.getData().length<30&&a.searchAndAddToStore(r,e,i)})}else{var o=Ext.getStore("search"!=this.currentData?this.currentData:this.prevCurrentData);o&&a.searchAndAddToStore(r,o,i)}"search"!=this.currentData&&(this.prevCurrentData=this.currentData,this.prevLanguage=this.language),this.currentData="search",this.language="searchName"}else this.currentView&&"DashboardView"!=this.currentView?this.prevCurrentData&&this.prevLanguage&&(this.currentData=this.prevCurrentData,this.language=this.prevLanguage):(this.currentData="types",this.language="name");this.goToDashboardView(!1)},searchAndAddToStore:function(t,e,a){e.filterBy(function(e){var r=e.data;for(var i in r)if(-1!=r[i].toString().toLowerCase().indexOf(t.toLowerCase())&&"src"!=i&&"id"!=i&&"xcount"!=i&&"xindex"!=i)return e.data.searchName=r[i],a.add(e),e}),e.clearFilter()},onRegionsListItemCommand:function(t){this.prevLanguage=null,this.language=t.getText(),this.goToDashboardView(!1)},onChangeViewCommand:function(t){-1!=t.getCls().indexOf("gridCls")?(t.removeCls("gridCls"),t.addCls("listCls"),this.currentFormat="Grid"):(t.removeCls("listCls"),t.addCls("gridCls"),this.currentFormat="List"),this.goToDashboardView(!1,!0)}});